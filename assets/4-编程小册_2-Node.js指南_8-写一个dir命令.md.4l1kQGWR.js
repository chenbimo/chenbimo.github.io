import{_ as s,c as n,o as a,U as l}from"./chunks/framework.QkLTjxkX.js";const C=JSON.parse('{"title":"写一个 dir 命令","description":"","frontmatter":{"isOriginal":true,"icon":"markdown","category":"Node.js指南","tag":["写一个 dir 命令"]},"headers":[],"relativePath":"4-编程小册/2-Node.js指南/8-写一个dir命令.md","filePath":"4-编程小册/2-Node.js指南/8-写一个dir命令.md","lastUpdated":null}'),p={name:"4-编程小册/2-Node.js指南/8-写一个dir命令.md"},e=l(`<h1 id="写一个-dir-命令" tabindex="-1">写一个 dir 命令 <a class="header-anchor" href="#写一个-dir-命令" aria-label="Permalink to &quot;写一个 dir 命令&quot;">​</a></h1><p>dir 是 directory（目录）的缩写，表示列举出当前目录下的所有文件夹和文件。</p><p>我们一般在 dos 命令行使用这个命令，演示看下图。</p><p><img src="https://static.chensuiyi.com/%E5%B0%8F%E5%86%8C/Nodejs%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%8D%97/24.png" alt="dir命令"></p><p>那么，我们用 Node.js 来实现一下这个命令，代码如下。</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> fs</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;fs&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> files</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> fs</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readdirSync</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.&#39;</span><span style="color:#ABB2BF;">, { </span><span style="color:#E06C75;">encoding</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;"> });</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> getDateTime</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">t</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> y</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> t</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getFullYear</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> m</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> t</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getMonth</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> d</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> t</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getDate</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#98C379;"> \`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">y</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">-</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">m</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">-</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">d</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 前置填充函数</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 输入：&#39;123&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 输出：&#39;   123&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E5C07B;font-style:italic;"> {string}</span><span style="color:#E06C75;font-style:italic;"> str</span><span style="color:#7F848E;font-style:italic;"> 字符串</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">str</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;     &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> str</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">substr</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">files</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 查询文件属性</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> stats</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> fs</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">statSync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // stats的值为一个文件属性对象</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     dev: 750391426,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     mode: 33206,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     nlink: 1,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     uid: 0,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     gid: 0,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     rdev: 0,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     blksize: 4096,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     ino: 18295873490538850,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     size: 152,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     blocks: 0,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     atimeMs: 1609907740867.3384,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     mtimeMs: 1609907740867.3384,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     ctimeMs: 1609907740867.3384,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     birthtimeMs: 1609907644280.0369,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     atime: 2021-01-06T04:35:40.867Z,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     mtime: 2021-01-06T04:35:40.867Z,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     ctime: 2021-01-06T04:35:40.867Z,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //     birthtime: 2021-01-06T04:34:04.280Z</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 定义每一行的结构，组成为：创建时间 + 文件大小 + 文件名 + 换行符</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> line</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getDateTime</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">stats</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">birthtime</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39; &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#61AFEF;"> padStart</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">stats</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">size</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#98C379;"> &#39; &#39;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> file</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &#39;</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 控制台输出，之所以不用console.log()，请同学们复制此代码自行实验。</span></span>
<span class="line"><span style="color:#E5C07B;">    process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">stdout</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">line</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>使用 <code>node dir.js</code> 执行后，结果如下。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">D:\\codes\\test\\nodejs\\t1&gt;node</span><span style="color:#98C379;"> dir.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">     1</span><span style="color:#D19A66;"> 1</span><span style="color:#98C379;">.txt</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">    57</span><span style="color:#98C379;"> a.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">    82</span><span style="color:#98C379;"> b.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">    59</span><span style="color:#98C379;"> c.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">    73</span><span style="color:#98C379;"> d.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">   519</span><span style="color:#98C379;"> dir.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-6</span><span style="color:#D19A66;">    29</span><span style="color:#98C379;"> hello-world.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-8</span><span style="color:#D19A66;">   222</span><span style="color:#98C379;"> read-write-file.js</span></span>
<span class="line"><span style="color:#61AFEF;">2021-1-6</span><span style="color:#D19A66;">   152</span><span style="color:#98C379;"> simple-http.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>更多内容，请访问 <a href="https://chensuiyi.com" target="_blank" rel="noreferrer">陈随易 https://chensuiyi.com</a>。</p>`,9),o=[e];function t(c,r,i,y,B,b){return a(),n("div",null,o)}const m=s(p,[["render",t]]);export{C as __pageData,m as default};
